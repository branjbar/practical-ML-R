---
title: "Pracices of Week 3"
output: html_document
author: Bijan Ranjbar-Sahraei
---

This is my first markdown R document. In this file I practice the 3rd week of Practical Machine Learning course.

## Predicting with Trees

First import the *iris* data and *ggplot2*
```{r}
data(iris); library(ggplot2)
```
First check the variables in *iris*:

```{r}
names(iris)
```

The *Species* variable is the output which we want to predict: 
```{r}
table(iris$Species)
```

Create training and test set

```{r}
library(caret)
inTrain <- createDataPartition(y=iris$Species,
                               p=0.7,
                               list=FALSE)
training <- iris[inTrain,]
testing <- iris[-inTrain,]
```
```{r}
dim(training)
```

```{r}
dim(testing)
```

let's plot the output  
```{r}
qplot(Petal.Width, Sepal.Width, color=Species, data=training)
```

We see very distinct colors which might be challenging for a linear model but not difficult for trees. Let's train a tree with *rpart* which is an R package for doing regression and classification trees. 

```{r}
modFit <- train(Species~., method="rpart", data=training) 
modFit$finalModel
```
It's also possible to use *party* or *tree* methods, but need more tweeking.
 
We can also plot the real tree in form of a dendrogram
```{r}
plot(modFit$finalModel, uniform=TRUE, main="Classification Tree")
text(modFit$finalModel, use.n=TRUE, all=TRUE, cex=.8)
```

A prettier version of the dendrogram can be plotted by the *rattle* package for which you might need *install.packages("RGtk2")*, *install.packages("rattle")* and *install.packages('rpart.plot')*. I had to install *XQuartz.app*, too.
```{r}
library(rattle)
fancyRpartPlot(modFit$finalModel)
```

now we use the decision tree to make predictions. 
```{r}
pred <- predict(modFit, testing)
confusionMatrix(pred,testing$Species)
```

## Bagging (Bootstrap Aggregating)

